<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medigator - Connect to Medic !</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .chart-box {
            width: 45%;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        canvas {
            width: 480px !important;
            height: 480px !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <div>
                <span style="color: aliceblue; font-size: x-large; font-weight: bold;">|</span>
                |
                <a style="text-decoration: none; color: aliceblue; font-size: x-large; font-weight: bold;">Welcome Admin!</a>
                |
                <span style="color: aliceblue; font-size: x-large; font-weight: bold;">|</span>
            </div>
            <input type="text" id="search" placeholder="Search" class="form-control me-2 " aria-label="Search" style="width: 300px;">
            <div>
                <span style="color: aliceblue; font-size: large; font-weight: bold;">|</span>
                |
                <a style="text-decoration: none; color: aliceblue;" href="#appoint"><span style="font-size: large;">Appointments</span></a>
                |
                <span style="color: aliceblue; font-size: large; font-weight: bold;">|</span>
                |
                <a style="text-decoration: none; color: aliceblue;" href="" data-bs-toggle="modal" data-bs-target="#chart_modal"><span style="font-size: large;">Summary</span></a>
                |
                <span style="color: aliceblue; font-size: large; font-weight: bold;">|</span>
                |
                <a style="text-decoration: none; color: aliceblue;" href="{{url_for('logout')}}"><span style="font-size: large;">Logout</span></a>
                |
                <span style="color: aliceblue; font-size: large; font-weight: bold;">|</span>
            </div>
            
        </div>
    </nav>
    <main>
        <div class="container mt-5">
            <div class="d-flex justify-content-between">
                <h3>Departments :</h3>
                <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#create_dept_Backdrop">CREATE</button>
            </div>
            <br>
            <table class="table table-bordered" id="s1">
                <thead class="text-center">
                    <tr>
                        <th>ID</th>
                        <th>NAME</th>
                        <th>NO OF DOCTORS</th>
                    </tr>
                </thead>
                <tbody class="text-center">
                    {% for dept in departments %}
                    <tr>
                        <td>{{dept.id}}</td>
                        <td>{{dept.name}}</td>
                        <td>{{dept.docsregistered}}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="3"> No Departments Registered Yet !</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <div class="d-flex justify-content-between">
                <h3>Registered Doctors :</h3> <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#create_doc_Backdrop">CREATE</button>
                
            </div>
            <br>
            <table class="table table-bordered" id="s2">
                <thead class="text-center">
                    <tr>
                        <th style="width:100px;">ID</th>
                        <th style="width: 375px;">DOCTOR</th>
                        <th style="width: 375px;">DEPT</th>
                        <th colspan="3" style="width:100px;">ACTIONS</th>
                    </tr>
                </thead>
                <tbody class="text-center">
                    {% for d in doctors%}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ d.name }}</td>
                        <td>{{d.department.name}}</td>
                        <td colspan="3" style="width: 50px;"> 
                            <div class="d-flex justify-content-around">
                                <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#edit_doc_Backdrop" data-name="{{d.name}}" data-exp="{{d.exp}}" data-des="{{d.description}}" data-fn="{{d.fn_slots}}"data-an="{{d.an_slots}}">
                                    EDIT
                                </button>
                                {% if d.blacklisted %}
                                <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#unblacklist_doc_modal" data-did="{{d.id}}" data-uid="{{d.user_id}}">UNBLACKLIST</button>
                                {% else %}
                                <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#blacklist_doc_modal" data-did="{{d.id}}" data-uid="{{d.user_id}}">BLACKLIST</button>
                                {% endif %}
                                <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#delete_doc_modal" data-did="{{d.id}}" data-uid="{{d.user_id}}">DELETE</button>
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5">No Doctors Registered</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <br>
            <h3>Registered Patients :</h3>
            <br>
            <table class="table table-bordered" id="s3">
                <thead class="text-center">
                    <tr>
                    <th style="width: 100px;">ID</th>
                    <th style="width: 600px;">PATIENT</th>
                    <th style="width: 200px;">HISTORY</th>
                    <th colspan="3">ACTIONS</th>
                    </tr>
                </thead>
                <tbody class="text-center">
                   {% for p in patients %}
                   <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ p.fullname}}</td>
                    <td>
                        <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#view_modalll_{{p.id}}">VIEW</button>
                        <div class="modal fade" id="view_modalll_{{p.id}}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                            <div class="modal-dialog modal-fullscreen">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h1 class="modal-title fs-3" id="staticBackdropLabel" style="font-size: xxx-large;">Patient History</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <container class="mt-4">
                                            <h3 class=" fs-5">Completed Appointments:</h3>
                                            <br>
                                            <table class="table table-bordered">
                                                <thead class="text-center">
                                                    <tr>
                                                        <th style="width: 100px;">ID</th>
                                                        <th style="width: 200px;">DOCTOR</th>
                                                        <th style="width: 200px;">DEPT</th>
                                                        <th style="width: 180px;">DATE</th>
                                                        <th style="width: 150px;">SLOT</th>
                                                        <th style="width: 200px;">STATUS</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="text-center">
                                                    {% for a in p.appointments if a.status in ["Completed","Cancelled"] %}
                                                    <tr>
                                                        <td>{{a.id}}</td>
                                                        <td>{{a.doctor.name}}</td>
                                                        <td>{{a.doctor.department.name}}</td>
                                                        <td>{{a.date}}</td>
                                                        <td>{{a.slot}}</td>
                                                        <td>{{a.status}}</td>
                                                    </tr>
                                                    {% else %}
                                                    <tr>
                                                        <td colspan="6">No History of Appointments!</td>
                                                    </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                            <br>
                                            <h3 class="fs-5">Treatment History:</h3>
                                            <br>
                                            <table class="table table-bordered table-fixed">
                                                <thead>
                                                    <th style="width: 150px;">APPOINTMENT ID</th>
                                                    <th style="width: 200px;">DIAGNOSIS</th>
                                                    <th style="width: 350px;">PRESCRIPTION</th>
                                                    <th style="width: 350px;">EXTRAS</th>
                                                </thead>
                                                <tbody>
                                                    

                                                    {% for a in p.appointments %}
                                                        {% set any_treatments = 0 %}
                                                        {% for t in a.treatment %}
                                                        {%  set any_treatments = any_treatments + 1 %}
                                                        <tr>
                                                            <td>{{ t.appointmentid }}</td>
                                                            <td>{{ t.diagnosis }}</td>
                                                            <td>{{ t.prescription }}</td>
                                                            <td>{{ t.notes }}</td>
                                                        </tr>
                                                        {% endfor %}
                                                        
                                                    {% endfor %}
                                                    {% if any_treatments==0 %}
                                                        <tr>
                                                            <td colspan="4">No Treatments Yet!</td>
                                                        </tr>
                                                     {% endif %}

                                                    
                                                </tbody>
                                            </table>
                                            <br>
                                        </container>
                                    </div>
                                </div>
                            </div>
                        </div>   
                    </td>
                    <td colspan="3" style="width: 50px;"> 
                        <div class="d-flex justify-content-around">
                            {% if p.blacklisted %}
                            <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#unblacklist_patient_modal" data-pid="{{p.id}}" >UNBLACKLIST</button>
                            {% else %}
                            <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#blacklist_patient_modal" data-pid="{{p.id}}" >BLACKLIST</button>
                            {% endif %}
                            <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#delete_patient_modal" data-pid="{{p.id}}" >DELETE</button>
                        </div>
                    </td>
                   </tr>
                   {% else %}
                   <tr>
                    <td colspan="5">No Patients Found !</td>
                   </tr>
                   {% endfor %}
                </tbody>
            </table>
            <br>
            <h3 id="appoint">Upcoming Appointments :</h3>
            <br>
            <table class="table table-bordered" id="s4">
                <thead class="text-center">
                    <tr>
                    <th style="width: 100px;">ID</th>
                    <th style="width: 250px;">PATIENT </th>
                    <th style="width: 250px;">DOCTOR</th>
                    <th style="width: 250px;">DEPT</th>
                    <th style="width: 180px;">PATIENT HISTORY</th>
                    </tr>
                </thead>
                <tbody class="text-center">
                   {% for a in appointments if a.status not in ["Completed","Cancelled"]%}
                   <tr>
                    <td>{{ a.id }}</td>
                    <td>{{ a.patient.fullname }}</td>
                    <td>{{ a.doctor.name}}</td>
                    <td>{{a.doctor.department.name}}</td>
                    <td>
                        <button class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#view_modalll_{{a.patientid }}">VIEW</button>
                        <div class="modal fade" id="view_modalll_{{a.patientid}}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                            <div class="modal-dialog modal-fullscreen">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h1 class="modal-title fs-3" id="staticBackdropLabel" style="font-size: xxx-large;">Patient History</h1>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <container class="mt-4">
                                            <h3 class=" fs-5">Completed Appointments:</h3>
                                            <br>
                                            <table class="table table-bordered">
                                                <thead class="text-center">
                                                    <tr>
                                                        <th style="width: 100px;">ID</th>
                                                        <th style="width: 200px;">DOCTOR</th>
                                                        <th style="width: 200px;">DEPT</th>
                                                        <th style="width: 180px;">DATE</th>
                                                        <th style="width: 150px;">SLOT</th>
                                                        <th style="width: 200px;">STATUS</th>
                                                    </tr>
                                                </thead>
                                                <tbody class="text-center">
                                                    {% for ap in appointments if ap.status in ["Completed","Cancelled"] and ap.patientid==a.patientid %}
                                                    <tr>
                                                        <td>{{ap.id}}</td>
                                                        <td>{{ap.doctor.name}}</td>
                                                        <td>{{ap.doctor.department.name}}</td>
                                                        <td>{{ap.date}}</td>
                                                        <td>{{ap.slot}}</td>
                                                        <td>{{ap.status}}</td>
                                                    </tr>
                                                    {% else %}
                                                    <tr>
                                                        <td colspan="6">No History of Appointments!</td>
                                                    </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                            <br>
                                            <h3 class="fs-5">Treatment History:</h3>
                                            <br>
                                            <table class="table table-bordered table-fixed">
                                                <thead>
                                                    <th style="width: 150px;">APPOINTMENT ID</th>
                                                    <th style="width: 200px;">DIAGNOSIS</th>
                                                    <th style="width: 350px;">PRESCRIPTION</th>
                                                    <th style="width: 350px;">EXTRAS</th>
                                                </thead>
                                                <tbody>
                                                    {% for t in treatments if t.appointment.patientid==a.patientid %}
                                                        <tr>
                                                            <td>{{t.appointmentid}}</td>
                                                            <td>{{t.diagnosis}}</td>
                                                            <td>{{t.prescription}}</td>
                                                            <td>{{t.notes}}</td>
                                                        </tr>
                                                    {% else %}
                                                        <td colspan="6">No Treatments Yet!</td>
                                                    {% endfor %}

                                                </tbody>
                                            </table>
                                            <br>
                                            
                                        </container>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                   </tr>
                   {% else %}
                   <tr>
                    <td colspan="5">No Current Appointments !</td>
                   </tr>
                   {% endfor %}
                </tbody>
            </table>
            
        </div>
        
        <!-- Modals -->
            <!-- create_dept -->
             <div class="modal fade" id="create_dept_Backdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="staticBackdropLabel">Enter Department Details :</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="{{url_for('create_dept')}}" method="POST">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Name</label>
                                    <input type="text" class="form-control" placeholder="" name="name" id="name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="des" class="form-label">Description</label>
                                    <input style="height: 120px" type="text" class="form-control" placeholder="" name="des" id="des" required>
                                </div>
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-outline-success d-flex">Create</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
             <!-- End_Create -->
            <!-- 1.Create_doc -->
            <div class="modal fade" id="create_doc_Backdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="staticBackdropLabel">Enter Doctor Details :</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="{{url_for('create_doc')}}" method="POST">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Name</label>
                                    <input type="text" class="form-control" placeholder="" name='name'id="name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="password" class="form-label">Password</label>
                                    <input type="password" class="form-control" placeholder="" name='password'id="password" required>
                                </div>
                                <div class="mb-3">
                                    <label for="dept" class="form-label">Department</label>
                                    <input type="text" class="form-control" placeholder="" name='dept'id="dept" required>
                                </div>
                                <div class="mb-3">
                                    <label for="exp" class="form-label">Experience</label>
                                    <input type="number" class="form-control" placeholder="" name='exp'id="exp" required>
                                </div>
                                <div class="mb-3">
                                    <label for="des" class="form-label">Description</label>
                                    <input style="height: 120px" type="text" class="form-control" placeholder="" name='des'id="des" required>
                                </div>
                                <div class="mb-3">
                                    <label for="fn" class="form-label">Forenoon Slots</label>
                                    <input  type="number" class="form-control" placeholder="" name='fn'id="fn" required>
                                </div>
                                <div class="mb-3">
                                    <label for="an" class="form-label">Afternoon Slots</label>
                                    <input type="number" class="form-control" placeholder="" name='an'id="an" required>
                                </div>
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Close</button>
                                    <button  type="submit" class="btn btn-outline-success d-flex">Create</button>
                                </div>
                                
                            </form>
                        </div>
                    </div>
                    </div>
                </div>
            <!-- End_Create -->
            <!-- 2.Edit_Doc -->
                <div class="modal fade" id="edit_doc_Backdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="staticBackdropLabel">Enter Updated Details :</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                                <div class="modal-body">
                                    <form action="{{url_for('edit_doc')}}" method="POST">
                                        <input type="hidden" name="name" id="edit-name">
                                        <!-- <div class="mb-3">
                                            <label for="dept" class="form-label">Department</label>
                                            <input type="text" class="form-control" placeholder="" name='dept'id="edit-dept" value="" required>
                                        </div> -->
                                        <div class="mb-3">
                                            <label for="exp" class="form-label">Experience</label>
                                            <input type="number" class="form-control" placeholder="" name='exp'id="edit-exp" value="" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="des" class="form-label">Description</label>
                                            <input style="height: 120px" type="text" class="form-control" placeholder="" name='des'id="edit-des" value="" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="fn" class="form-label">Forenoon Slots</label>
                                            <input  type="number" class="form-control" placeholder="" name='fn'id="edit-fn" value="" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="an" class="form-label">Afternoon Slots</label>
                                            <input type="number" class="form-control" placeholder="" name='an'id="edit-an" value="" required>
                                        </div>
                                        <div class="d-flex justify-content-end gap-2">
                                            <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Close</button>
                                            <button  type="submit" class="btn btn-outline-success d-flex">Edit</button>
                                        </div> 
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
            <!-- End_edit -->
            <!-- 3.Delete_doc -->
             <div class="modal fade" id="delete_doc_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Enter Updated Details :</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                        
                        <div class="modal-body">
                            <form action="{{url_for('delete_doc')}}" method="POST">
                                <input type="hidden" name="did" id="did" value="">
                                <input type="hidden" name="uid" id="uid" value="">
                                Are you sure? Wanna delete the doctor?
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
                                    <button  type="submit" class="btn btn-outline-danger d-flex">Delete</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End_Delete -->
             <!-- 4.Patient_delete -->
              <div class="modal fade" id="delete_patient_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="staticBackdropLabel">Enter Updated Details :</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form action="{{url_for('delete_patient')}}" method="POST">
                                <input type="hidden" name="pid" id="patient-pid" value="">
                                Are you sure? Wanna delete the patient?
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-outline-danger d-flex">Delete</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
              <!-- End_delete -->
               <!-- black_doc_modal -->
                <div class="modal fade" id="blacklist_doc_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Blacklist Doctor</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form action="{{url_for('blacklist_doctor')}}" method="POST">
                                    <input type="hidden" name="did" id="blacklist-doc-did" value="">
                                    <input type="hidden" name="uid" id="blacklist-doc-uid" value="">
                                    <p>Are you sure you want to blacklist this doctor?</p>
                                    <p class="text-danger"><strong>They will not be able to login until unblacklisted.</strong></p>
                                    <div class="d-flex justify-content-end gap-2">
                                        <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Cancel</button>
                                        <button type="submit" class="btn btn-outline-danger d-flex">Blacklist</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End_black_modal -->

                <!--ublack _doc_modal -->
                <div class="modal fade" id="unblacklist_doc_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Unblacklist Doctor</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form action="{{url_for('unblacklist_doctor')}}" method="POST">
                                    <input type="hidden" name="did" id="unblacklist-doc-did" value="">
                                    <input type="hidden" name="uid" id="unblacklist-doc-uid" value="">
                                    <p>Are you sure you want to unblacklist this doctor?</p>
                                    <p class="text-success"><strong>They will be able to login again.</strong></p>
                                    <div class="d-flex justify-content-end gap-2">
                                        <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Cancel</button>
                                        <button type="submit" class="btn btn-outline-success d-flex">Unblacklist</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End_unblack_modal -->

                <!-- black_pat_modal -->
                <div class="modal fade" id="blacklist_patient_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Blacklist Patient</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form action="{{url_for('blacklist_patient')}}" method="POST">
                                    <input type="hidden" name="pid" id="blacklist-patient-pid" value="">
                                    <p>Are you sure you want to blacklist this patient?</p>
                                    <p class="text-danger"><strong>They will not be able to login until unblacklisted.</strong></p>
                                    <div class="d-flex justify-content-end gap-2">
                                        <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Cancel</button>
                                        <button type="submit" class="btn btn-outline-danger d-flex">Blacklist</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End_black_pat_modal -->

                <!-- unblack_pat_modal -->
                <div class="modal fade" id="unblacklist_patient_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Unblacklist Patient</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form action="{{url_for('unblacklist_patient')}}" method="POST">
                                    <input type="hidden" name="pid" id="unblacklist-patient-pid" value="">
                                    <p>Are you sure you want to unblacklist this patient?</p>
                                    <p class="text-success"><strong>They will be able to login again.</strong></p>
                                    <div class="d-flex justify-content-end gap-2">
                                        <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">Cancel</button>
                                        <button type="submit" class="btn btn-outline-success d-flex">Unblacklist</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End-unlack_Modal -->
                 <!-- Chart_modal -->
                <div class="modal fade" id="chart_modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog  modal-fullscreen">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Overview</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="chart-container">
                                    <div class="chart-box">
                                        <canvas id="adminChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end_chart_modal -->
         <!-- End_Modals -->
    </main>

</body>
<script>
  var edit_doc_modal = document.getElementById('edit_doc_Backdrop');//refer modal
  edit_doc_modal.addEventListener('show.bs.modal', function (event) {//add event default
    var button = event.relatedTarget; // default
    var name = button.getAttribute('data-name');//data-name is from button stored to name
    var exp = button.getAttribute('data-exp') //same^
    var des =button.getAttribute('data-des')
    var fn = button.getAttribute('data-fn')
    var an = button.getAttribute('data-an')
    document.getElementById('edit-name').value = name;//edit-name is id of hidden input tag. that input's value assigned with the name's value
    document.getElementById('edit-exp').value = exp;
    document.getElementById('edit-des').value = des;
    document.getElementById('edit-an').value = an;
    document.getElementById('edit-fn').value = fn;
    });
    var delete_doc_modal = document.getElementById('delete_doc_modal');//refer modal
    delete_doc_modal.addEventListener('show.bs.modal', function (event) {//add event default
    var button = event.relatedTarget; // default
    var did = button.getAttribute('data-did');
    var uid = button.getAttribute('data-uid');//data-name is from button stored to name
    document.getElementById('uid').value = uid;//edit-name is id of hidden input tag. that input's value assigned with the name's value
    document.getElementById('did').value = did;
    });

    // Delete Patient Modal
    var delete_patient_modal = document.getElementById('delete_patient_modal');
    delete_patient_modal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var pid = button.getAttribute('data-pid');
        
        document.getElementById('patient-pid').value = pid;
    });

    var blacklist_doc_modal = document.getElementById('blacklist_doc_modal');
    blacklist_doc_modal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var did = button.getAttribute('data-did');
        document.getElementById('blacklist-doc-did').value = did;
    });

    // Unblacklist Doctor Modal
    var unblacklist_doc_modal = document.getElementById('unblacklist_doc_modal');
    unblacklist_doc_modal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var did = button.getAttribute('data-did');
        document.getElementById('unblacklist-doc-did').value = did;
    });

    // Blacklist Patient Modal
    var blacklist_patient_modal = document.getElementById('blacklist_patient_modal');
    blacklist_patient_modal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var pid = button.getAttribute('data-pid');
        document.getElementById('blacklist-patient-pid').value = pid;
    });

    // Unblacklist Patient Modal
    var unblacklist_patient_modal = document.getElementById('unblacklist_patient_modal');
    unblacklist_patient_modal.addEventListener('show.bs.modal', function (event) {
        var button = event.relatedTarget;
        var pid = button.getAttribute('data-pid');
        document.getElementById('unblacklist-patient-pid').value = pid;
    });

    document.getElementById("search").addEventListener("keyup", function() {
    let filter = this.value.toLowerCase();
    ['s1','s2','s3','s4'].forEach(sid => {
       let rows = document.querySelectorAll(`#${sid} tbody tr`);
        rows.forEach(row => {
            let text = row.textContent.toLowerCase();
            row.style.display = text.includes(filter) ? "" : "none";
            }); 
        });      
    });


// Chart

const ctx = document.getElementById('adminChart');

new Chart(ctx, {
    type: 'pie',
    data: {
        labels: ['Appointments', 'Patients', 'Doctors'],
        datasets: [{
            label: 'Admin Overview',
            data: [{{ total_appointments }},{{ active_patients }},{{ doctorss }}],
            borderWidth: 1
        }]
    },
    options: {
        scales: { y: { beginAtZero: true } }
    }
});
</script>
</html>